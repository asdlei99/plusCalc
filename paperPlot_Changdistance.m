% 绘制论文用图
close all;

%原始的0m间距实验数据
raw0 = [...
5,7,8,9,11,12,16,17,19,20,22,23.5,25,26,28;...
8.127,5.80325,6.27525,4.61225,3.02775,2.63225,2.69875,3.9385,3.37575,3.30875,3.19475,2.55575,2.358666667,2.079,1.0265 ...
];
theory0 = [...
10.47319701,11.53010439,12.24364766,12.57818613,12.51538156,12.05265824,11.20222765,9.990143579,8.455205556,6.647758668,4.628983296,2.475658727,0.511810408,2.136560879,2.75550905,3.168961433,3.491005851,3.70597266,3.803959914,3.780039085,3.633911715,3.369667965,2.995516513,2.52343581,1.968731019,1.34949772,0.686002956,3.71E-15 ...
];
theory0X = [0:13,(0:13) + 13 + 2+0.115*4];

% 0.5m间距
%6.7405,6.761,6.11325,5.941,5.2735,3.49975,2.84,3.0325,3.34175,3.18525,3.8035,3.65,3.48875,2.62275,2.57
raw05 = [...
5,7,8,9,11,12,16.5,17.5,19.5,20.5,22.5,24,26.5;...
6.9405,6.761,6.11325,5.541,4.6735,3.49975,2.889,3.18525,3.8035,3.65,3.48875,2.92275,2.17 ...
];
theory05 = [...
9.661737841,10.72882392,11.48232412,11.88393916,11.91242933,11.56182894,10.84043344,9.769913678,8.384327064,6.729038812,4.860025435,2.847002685,0.853703306,1.556908514,2.899150689,3.334155888,3.672988125,3.899160915,4.002256137,3.977088342,3.823343513,3.545325029,3.151669476,2.654979728,2.07135879,1.419845544,0.721763531,1.80E-15 ...
];
theory05X = [0:13,(0:13) + 13 + 2+0.115*4+0.5];
%1m间距
%6.05,6.4196,5.5046,4.7338,3.357,3.1278,2.4942,3.6512,3.4042,3.948,4.1894,4.1658,3.6354,3.1374,3.5212
raw1 = [...
5,7,8,9,11,12,17,18,20,21,23,24.5,26;...
6.605,6.4196,5.5046,4.7338,3.357,3.1278,3.4042,3.948,4.1894,4.1658,3.6354,3.1374,2.5212 ...
];
theory1 = [...
8.952017889,10.02387029,10.8096269,11.26825352,11.37576794,11.12312236,10.5151083,9.569501054,8.31615886,6.796057757,5.060660349,3.17424553,1.255391515,1.090628146,3.041070286,3.497369916,3.852788712,4.090033142,4.198175094,4.171775282,4.010504316,3.718876236,3.305950405,2.784946637,2.172756211,1.489350006,0.757095393,2.84E-15 ...
];
theory1X = [0:13,(0:13) + 13 + 2+0.115*4+1];
% 直管
rawStraight = [...
    7:28 ;...
    8.424323798,8.086675176,7.366043267,6.566389551,5.890767701,5.462666823,5.341473771,5.533709769,6.002112895,6.674540052,7.454202313,8.231869744,8.899693563,9.365352983,9.564541664,9.469550061,9.091904302,8.477665747,7.69491878,6.814012228,5.882026358,4.893503814 ...
];
theoryStraight = [...
    9.847895188,10.60828429,11.12495889,11.35585355,11.2782133,10.88600787,10.18868347,9.210901317,7.99375816,6.599750504,5.129366997,3.776796608,2.974513524,3.26031804,4.386673285,5.782089254,7.156853687,8.376456656,9.363791807,10.06864049,10.45825744,10.51420951,10.23114337,9.616077039,8.687705096,7.475521187,6.018688377,4.3646469,2.567480584,0.686082276 ...
];
% 直管拟合
ft = fittype( ['fourier','3'] );%3阶傅里叶拟合
fopts = fitoptions( ft );
[fitresultStraight, gof] = fit( rawStraight(1,:)',rawStraight(2,:)', ft, fopts );


figure
X = raw0(1,:);
Y = raw0(2,:);
h(1) = plot(X,Y,'o');
hold on;
ft = fittype( ['fourier','3'] );%3阶傅里叶拟合
fopts = fitoptions( ft );
[fitresult0, gof] = fit( X',Y', ft, fopts );
xFit0 = raw0(1,1):0.5:raw0(1,end);
yFit0 = feval(fitresult0,xFit0);
yFitStraight = feval(fitresultStraight,xFit0);
h(2) = plot(xFit0,yFit0,'-');
h(3) = plot(theory0X,theory0,'-','color',[240,57,57]./255);
set(gcf,'color','w');
title('0m间距');

figure
X = raw05(1,:)-1;
Y = raw05(2,:);
h(1) = plot(X,Y,'o');
hold on;
ft = fittype( ['fourier','3'] );%3阶傅里叶拟合
fopts = fitoptions( ft );
% fopts.Display = 'Off';
[fitresult05, gof] = fit( X',Y', ft, fopts );
xFit05 = X(1):0.5:X(end);
yFit05 = feval(fitresult05,xFit05);
h(2) = plot(xFit05,yFit05,'-');
h(3) = plot(theory05X,theory05,'-','color',[240,57,57]./255);
set(gcf,'color','w');
title('0.5m间距');

figure
X = raw1(1,:);
Y = raw1(2,:);
h(1) = plot(X,Y,'o');
hold on;
ft = fittype( ['fourier','3'] );%3阶傅里叶拟合
fopts = fitoptions( ft );
% fopts.Display = 'Off';
[fitresult, gof] = fit( X',Y', ft, fopts );
xFit1 = raw1(1,1):0.5:raw1(1,end);
yFit1 = feval(fitresult,xFit1);
h(2) = plot(xFit1,yFit1,'-');
h(3) = plot(theory1X,theory1,'-','color',[240,57,57]./255);
set(gcf,'color','w');
title('1m间距');

figure
h = [];
h(1) = plot(xFit0(1:2:end),yFit0(1:2:end),'-.o','color',[240,57,57]./255);
hold on;
h(2) = plot(xFit05(1:2:end),yFit05(1:2:end),'--^','color',[116,33,240]./255);
h(3) = plot(xFit1(1:2:end),yFit1(1:2:end),'-s','color',[44,162,70]./255);
set(gcf,'color','w');
h(4) = plot(theory0X,theory0,'-.','color',[240,57,57]./255);
hold on;
h(5) = plot(theory05X,theory05,'--','color',[116,33,240]./255);
h(6) = plot(theory1X,theory1,'-','color',[44,162,70]./255);
grid on;
legend(h,{'实验0m间距','实验0.5m间距','实验1m间距','理论0m间距','理论0.5m间距','理论1m间距'});
xlabel('距离(m)');
ylabel('脉动峰峰值(kPa)');
title('实验数据结果对比');

