% 绘制论文用图
close all;

%原始的0m间距实验数据
raw0 = [...
5,7,8,9,11,12,16,17,19,20,22,23.5,25,26,28;...
8.127,5.80325,6.27525,4.61225,3.02775,2.63225,2.69875,3.9385,3.37575,3.30875,3.19475,2.55575,2.358666667,2.079,1.0265 ...
];
simulation0 = [...
8.11810742000000,9.37190430000000,9.37061718000000,10.1230859400000,10.1040053700000,9.55507886000000,9.47821436000000,9.61385009000000,9.44684864000000,8.94036206000000,7.75906055000000,5.93366381000000,3.29463366000000,1.40659570300000,2.52057776000000,3.38324451000000,4.08005273000000,4.47644849000000,4.58614843000000,4.51213086000000,4.35987756000000,4.30667138000000,4.18965283000000,3.90014966000000,3.28628845000000,2.37959729000000,2.73587171000000,1.04756021400000e-05];

theory0X = [0:13,(0:13) + 13 + 2+0.115*4];

% 0.5m间距
%6.7405,6.761,6.11325,5.941,5.2735,3.49975,2.84,3.0325,3.34175,3.18525,3.8035,3.65,3.48875,2.62275,2.57
raw05 = [...
5,7,8,9,11,12,16.5,17.5,19.5,20.5,22.5,24,26.5;...
6.9405,6.761,6.11325,5.541,4.6735,3.49975,2.889,3.18525,3.8035,3.65,3.48875,2.92275,2.17 ...
];
simulation05 = [...
8.13764575000000,8.83172339000000,9.45126977000000,9.81839502000000,9.64985010000000,9.31089722000000,9.41805176000000,9.94621045000000,9.78008838000000,9.42066748000000,7.81945752000000,5.85721387000000,3.38770325000000,2.37313702200000,3.10276281000000,4.19289563000000,4.99577795000000,5.30338575000000,5.11102698000000,4.86475744000000,4.96862500000000,4.94000366000000,4.94136059000000,4.73009619000000,4.01352454000000,2.96026843000000,2.56182080000000,0.000758715804200000 ...
];
theory05X = [0:13,(0:13) + 13 + 2+0.115*4+0.5];
%1m间距
%6.05,6.4196,5.5046,4.7338,3.357,3.1278,2.4942,3.6512,3.4042,3.948,4.1894,4.1658,3.6354,3.1374,3.5212
raw1 = [...
5,7,8,9,11,12,17,18,20,21,23,24.5,26;...
6.605,6.4196,5.5046,4.7338,3.357,3.1278,3.4042,3.948,4.1894,4.1658,3.6354,3.1374,2.5212 ...
];
simulation1 = [...
7.26641016000000,8.88764697000000,9.59052490000000,9.67776465000000,8.98515893000000,8.47430297000000,9.24528662000000,10.3797880900000,10.8082280200000,10.2245905700000,8.67232007000000,6.34873853000000,3.47661682000000,2.38029754000000,2.70396508400000,3.54199402000000,4.52627221000000,5.18219165000000,5.57190259000000,5.70551391000000,5.63304517000000,5.37766357000000,4.94645789000000,4.62832019000000,3.96212707000000,2.92396424000000,1.49446930000000,0.00179264351033000];

theory1X = [0:13,(0:13) + 13 + 2+0.115*4+1];
% 直管
rawStraight = [...
    7:28 ;...
    8.424323798,8.086675176,7.366043267,6.566389551,5.890767701,5.462666823,5.341473771,5.533709769,6.002112895,6.674540052,7.454202313,8.231869744,8.899693563,9.365352983,9.564541664,9.469550061,9.091904302,8.477665747,7.69491878,6.814012228,5.882026358,4.893503814 ...
];
theoryStraight = [...
    9.847895188,10.60828429,11.12495889,11.35585355,11.2782133,10.88600787,10.18868347,9.210901317,7.99375816,6.599750504,5.129366997,3.776796608,2.974513524,3.26031804,4.386673285,5.782089254,7.156853687,8.376456656,9.363791807,10.06864049,10.45825744,10.51420951,10.23114337,9.616077039,8.687705096,7.475521187,6.018688377,4.3646469,2.567480584,0.686082276 ...
];
% 直管拟合
ft = fittype( ['fourier','3'] );%3阶傅里叶拟合
fopts = fitoptions( ft );
[fitresultStraight, gof] = fit( rawStraight(1,:)',rawStraight(2,:)', ft, fopts );


figure
X = raw0(1,:);
Y = raw0(2,:);
h(1) = plot(X,Y,'o');
hold on;
ft = fittype( ['fourier','3'] );%3阶傅里叶拟合
fopts = fitoptions( ft );
[fitresult0, gof] = fit( X',Y', ft, fopts );
xFit0 = raw0(1,1):0.5:raw0(1,end);
yFit0 = feval(fitresult0,xFit0);
yFitStraight = feval(fitresultStraight,xFit0);
h(2) = plot(xFit0,yFit0,'-');
h(3) = plot(theory0X,simulation0,'-','color',[240,57,57]./255);
set(gcf,'color','w');
title('0m间距');

figure
X = raw05(1,:)-1;
Y = raw05(2,:);
h(1) = plot(X,Y,'o');
hold on;
ft = fittype( ['fourier','3'] );%3阶傅里叶拟合
fopts = fitoptions( ft );
% fopts.Display = 'Off';
[fitresult05, gof] = fit( X',Y', ft, fopts );
xFit05 = X(1):0.5:X(end);
yFit05 = feval(fitresult05,xFit05);
h(2) = plot(xFit05,yFit05,'-');
h(3) = plot(theory05X,simulation05,'-','color',[240,57,57]./255);
set(gcf,'color','w');
title('0.5m间距');

figure
X = raw1(1,:);
Y = raw1(2,:);
h(1) = plot(X,Y,'o');
hold on;
ft = fittype( ['fourier','3'] );%3阶傅里叶拟合
fopts = fitoptions( ft );
% fopts.Display = 'Off';
[fitresult, gof] = fit( X',Y', ft, fopts );
xFit1 = raw1(1,1):0.5:raw1(1,end);
yFit1 = feval(fitresult,xFit1);
h(2) = plot(xFit1,yFit1,'-');
h(3) = plot(theory1X,simulation1,'-','color',[240,57,57]./255);
set(gcf,'color','w');
title('1m间距');

figure
h = [];
h(1) = plot(xFit0(1:2:end),yFit0(1:2:end),'-.o','color',[240,57,57]./255);
hold on;
h(2) = plot(xFit05(1:2:end),yFit05(1:2:end),'--^','color',[116,33,240]./255);
h(3) = plot(xFit1(1:2:end),yFit1(1:2:end),'-s','color',[44,162,70]./255);
set(gcf,'color','w');
h(4) = plot(theory0X,simulation0,'-.','color',[240,57,57]./255);
hold on;
h(5) = plot(theory05X,simulation05,'--','color',[116,33,240]./255);
h(6) = plot(theory1X,simulation1,'-','color',[44,162,70]./255);
grid on;
legend(h,{'实验0m间距','实验0.5m间距','实验1m间距','模拟0m间距','模拟0.5m间距','模拟1m间距'});
xlabel('距离(m)');
ylabel('脉动峰峰值(kPa)');
title('实验数据结果对比');

